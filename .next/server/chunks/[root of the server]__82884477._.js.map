{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/vikas/OneDrive/Desktop/Recal%21pro/utils/auth.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from 'jose'\r\nimport { cookies } from 'next/headers'\r\nimport bcrypt from 'bcryptjs'\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key'\r\n\r\n// Cookie settings\r\nconst COOKIE_OPTIONS = {\r\n  httpOnly: true,\r\n  secure: process.env.NODE_ENV === 'production',\r\n  sameSite: 'lax' as const,\r\n  maxAge: 60 * 60 * 24 * 7 // 7 days\r\n}\r\n\r\nexport async function hashPassword(password: string): Promise<string> {\r\n  const salt = await bcrypt.genSalt(10)\r\n  return bcrypt.hash(password, salt)\r\n}\r\n\r\nexport async function comparePasswords(password: string, hashedPassword: string): Promise<boolean> {\r\n  return bcrypt.compare(password, hashedPassword)\r\n}\r\n\r\nexport async function createSession(userId: string): Promise<string> {\r\n  const token = await new SignJWT({ userId })\r\n    .setProtectedHeader({ alg: 'HS256' })\r\n    .setExpirationTime('7d') // Match cookie maxAge\r\n    .sign(new TextEncoder().encode(JWT_SECRET))\r\n  \r\n  return token\r\n}\r\n\r\nexport async function verifySession(token: string): Promise<string | null> {\r\n  try {\r\n    const verified = await jwtVerify(token, new TextEncoder().encode(JWT_SECRET))\r\n    return verified.payload.userId as string\r\n  } catch (error) {\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function setSessionCookie(token: string) {\r\n  const cookieStore = await cookies()\r\n  cookieStore.set('session', token, COOKIE_OPTIONS)\r\n}\r\n\r\nexport async function getSessionToken(): Promise<string | undefined> {\r\n  const cookieStore = await cookies()\r\n  return cookieStore.get('session')?.value\r\n}\r\n\r\nexport async function clearSession() {\r\n  const cookieStore = await cookies()\r\n  cookieStore.delete('session')\r\n}\r\n\r\nexport async function requireAuth() {\r\n  const token = await getSessionToken()\r\n  if (!token) {\r\n    throw new Error('Unauthorized')\r\n  }\r\n  \r\n  const userId = await verifySession(token)\r\n  if (!userId) {\r\n    throw new Error('Invalid session')\r\n  }\r\n  \r\n  return userId\r\n} "],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AACA;AACA;;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAE7C,kBAAkB;AAClB,MAAM,iBAAiB;IACrB,UAAU;IACV,QAAQ,oDAAyB;IACjC,UAAU;IACV,QAAQ,KAAK,KAAK,KAAK,EAAE,SAAS;AACpC;AAEO,eAAe,aAAa,QAAgB;IACjD,MAAM,OAAO,MAAM,mIAAA,CAAA,UAAM,CAAC,OAAO,CAAC;IAClC,OAAO,mIAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,iBAAiB,QAAgB,EAAE,cAAsB;IAC7E,OAAO,mIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,eAAe,cAAc,MAAc;IAChD,MAAM,QAAQ,MAAM,IAAI,uJAAA,CAAA,UAAO,CAAC;QAAE;IAAO,GACtC,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,iBAAiB,CAAC,MAAM,sBAAsB;KAC9C,IAAI,CAAC,IAAI,cAAc,MAAM,CAAC;IAEjC,OAAO;AACT;AAEO,eAAe,cAAc,KAAa;IAC/C,IAAI;QACF,MAAM,WAAW,MAAM,CAAA,GAAA,yJAAA,CAAA,YAAS,AAAD,EAAE,OAAO,IAAI,cAAc,MAAM,CAAC;QACjE,OAAO,SAAS,OAAO,CAAC,MAAM;IAChC,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,iBAAiB,KAAa;IAClD,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IAChC,YAAY,GAAG,CAAC,WAAW,OAAO;AACpC;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IAChC,OAAO,YAAY,GAAG,CAAC,YAAY;AACrC;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IAChC,YAAY,MAAM,CAAC;AACrB;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM;IACpB,IAAI,CAAC,OAAO;QACV,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,SAAS,MAAM,cAAc;IACnC,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/vikas/OneDrive/Desktop/Recal%21pro/app/api/auth/check-session/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport { cookies } from 'next/headers'\r\nimport { verifySession } from '@/utils/auth'\r\n\r\nexport async function GET() {\r\n  try {\r\n    const cookieStore = await cookies()\r\n    const sessionToken = cookieStore.get('session')?.value\r\n\r\n    if (!sessionToken) {\r\n      return NextResponse.json({ authenticated: false })\r\n    }\r\n\r\n    // Verify the session token\r\n    const userId = await verifySession(sessionToken)\r\n    \r\n    return NextResponse.json({\r\n      authenticated: Boolean(userId)\r\n    })\r\n  } catch (error) {\r\n    console.error('Session check error:', error)\r\n    return NextResponse.json({ authenticated: false })\r\n  }\r\n} "],"names":[],"mappings":";;;AAAA;AACA;AACA;;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;QAChC,MAAM,eAAe,YAAY,GAAG,CAAC,YAAY;QAEjD,IAAI,CAAC,cAAc;YACjB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,eAAe;YAAM;QAClD;QAEA,2BAA2B;QAC3B,MAAM,SAAS,MAAM,CAAA,GAAA,+GAAA,CAAA,gBAAa,AAAD,EAAE;QAEnC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,eAAe,QAAQ;QACzB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,eAAe;QAAM;IAClD;AACF","debugId":null}}]
}